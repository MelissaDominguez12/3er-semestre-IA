--Crear usuario
--ALTER SESSION SET "_ORACLE_SCRIPT"=TRUE; 
--CREATE USER fundamentals IDENTIFIED by atleta
--DEFAULT TABLESPACE users
--TEMPORARY TABLESPACE temp;
--GRANT CONNECT, RESOURCE TO atleta;
--GRANT UNLIMITED TABLESPACE TO atleta;


--Ajustes de sistema
set linesize 300
set pagesize 50
set feddback on
set colsep ' ||' 
set null s/dato
clear screen
spool C:\Users\melis\OneDrive\Escritorio\Bach.txt
--Cambiar idioma 
ALTER SESSION SET NLS_DATE_LANGUAGE  = 'ENGLISH';

CREATE TABLE BANK(
    Code VARCHAR2(10) NOT NULL,
    Name VARCHAR2(25) NOT NULL,
    ADDRESS VARCHAR2(25) NOT NULL
);

CREATE TABLE BANK_BRANCH(
    Branch_no INTEGER NOT NULL,
    Address VARCHAR2(25) NOT NULL,
    Code VARCHAR2(10) NOT NULL
);

CREATE TABLE ACCOUNT(
    Account_no INTEGER NOT NULL,
    Type VARCHAR2(25) NOT NULL,
    Balance INTEGER NOT NULL,
    Code VARVCHAR2(10) NOT NULL
);

CREATE TABLE LOAN(
    Loan_no INTEGER NOT NULL,
    Amount INTEGER NOT NULL,
    Code VARCHAR2(10) NOT NULL
);

CREATE TABLE CUSTOMER(
    Ssn INTEGER NOT NULL,
    Name VARCHAR2(25) NOT NULL,
    Address VARCHAR2(25) NOT NULL
    Phone INTEGER 
 
);

CREATE TABLE A_C(
    Account_no INTEGER NOT NULL,
    Ssn INTEGER NOT NULL,
  Code VARCHAR2(10) NOT NULL
);

CREATE TABLE L_C(
    Loan_no INTEGER NOT NULL,
    Ssn INTEGER NOT NULL
);


--LLAVES PK
ALTER TABLE BANK ADD CONSTRAINT BANK_PK PRIMARY KEY (Code);
ALTER TABLE BANK_BRANCH ADD CONSTRAINT BANK_BRANCH_PK PRIMARY KEY (Branch_no);
ALTER TABLE ACCOUNT ADD CONSTRAINT ACCOUNT_PK PRIMARY KEY (Account_no);
ALTER TABLE LOAN ADD CONSTRAINT LOAN_PK PRIMARY KEY (Loan_no);
ALTER TABLE CUSTOMER ADD CONSTRAINT CUSTOMER_PK PRIMARY KEY (Ssn);
ALTER TABLE A_C ADD CONSTRAINT A_C_PK PRIMARY KEY (Account_no, Ssn);
ALTER TABLE L_C ADD CONSTRAINT L_C_PK PRIMARY KEY (Loan_no, Ssn);

--LLAVES FK
ALTER TABLE BANK_BRANCH ADD CONSTRAINT BANK_BRANCH_FK FOREIGN KEY (Code) REFERENCES BANK(Code);
ALTER TABLE ACCOUNT ADD CONSTRAINT ACCOUNT_FK FOREIGN KEY (Code) REFERENCES BANK(Code);
ALTER TABLE LOAN ADD CONSTRAINT LOAN_FK FOREIGN KEY (Code) REFERENCES BANK(Code);
ALTER TABLE A_C ADD CONSTRAINT A_C_FK1 FOREIGN KEY (Account_no) REFERENCES ACCOUNT(Account_no);
ALTER TABLE A_C ADD CONSTRAINT A_C_FK2 FOREIGN KEY (Ssn) REFERENCES CUSTOMER(Ssn);
ALTER TABLE L_C ADD CONSTRAINT L_C_FK1 FOREIGN KEY (Loan_no) REFERENCES LOAN(Loan_no);
ALTER TABLE L_C ADD CONSTRAINT L_C_FK2 FOREIGN KEY (Ssn) REFERENCES CUSTOMER(Ssn);

--Insertar datos

INSERT INTO BANK VALUES ('B001', 'Banco de Bogota', 'Calle 73 # 10-34');
INSERT INTO BANK VALUES ('B002', 'Banco de Occidente', 'Calle 73 # 10-35');
INSERT INTO BANK VALUES ('B003', 'Banco de la Republica', 'Calle 72# 10-32');
INSERT INTO BANK VALUES ('B004', 'Banco de la Nacion', 'Calle 72 # 10-34');
INSERT INTO BANK VALUES ('B005', 'Banco Central', 'Calle 71 # 10-34');

INSERT INTO BANK_BRANCH VALUES (1, 'Calle 73 # 10-34', 'B001');
INSERT INTO BANK_BRANCH VALUES (2, 'Calle 73 # 10-35', 'B002');
INSERT INTO BANK_BRANCH VALUES (3, 'Calle 72 # 10-32', 'B003');
INSERT INTO BANK_BRANCH VALUES (4, 'Calle 72 # 10-34', 'B004');
INSERT INTO BANK_BRANCH VALUES (5, 'Calle 71 # 10-34', 'B005');

INSERT INTO ACCOUNT VALUES (1, 'Ahorros', 1000000, 'B001');
INSERT INTO ACCOUNT VALUES (2, 'Corriente', 2000000, 'B002');
INSERT INTO ACCOUNT VALUES (3, 'Abonos', 3000000, 'B003');
INSERT INTO ACCOUNT VALUES (4, 'Prestamos', 4000000, 'B004');
INSERT INTO ACCOUNT VALUES (5, 'Apartados', 5000000, 'B005');

INSERT INTO LOAN VALUES (1, 1000000, 'B001');
INSERT INTO LOAN VALUES (2, 2000000, 'B002');
INSERT INTO LOAN VALUES (3, 3000000, 'B003');
INSERT INTO LOAN VALUES (4, 4000000, 'B004');
INSERT INTO LOAN VALUES (5, 5000000, 'B005');

INSERT INTO CUSTOMER VALUES (1, 'Melissa', 'Calle 73 # 10-34', 1234567);
INSERT INTO CUSTOMER VALUES (2, 'Juan', 'Calle 73 # 10-35', 1234568);
INSERT INTO CUSTOMER VALUES (3, 'Maria', 'Calle 72 # 10-32', 1234569);
INSERT INTO CUSTOMER VALUES (4, 'Pedro', 'Calle 72 # 10-34', 1234560);
INSERT INTO CUSTOMER VALUES (5, 'Luis', 'Calle 71 # 10-34', 1234561);

INSERT INTO A_C VALUES (1, 1, 'B001');
INSERT INTO A_C VALUES (2, 2, 'B002');
INSERT INTO A_C VALUES (3, 3, 'B003');
INSERT INTO A_C VALUES (4, 4, 'B004');
INSERT INTO A_C VALUES (5, 5, 'B005');

INSERT INTO L_C VALUES (1, 1);
INSERT INTO L_C VALUES (2, 2);
INSERT INTO L_C VALUES (3, 3);
INSERT INTO L_C VALUES (4, 4);
INSERT INTO L_C VALUES (5, 5);

--Consultas
--1. Mostrar el nombre de los bancos que tienen sucursales en la ciudad de Bogota
SELECT B.NAME
FROM BANK B, BANK_BRANCH BB
WHERE B.CODE = BB.CODE AND BB.ADDRESS LIKE '%Bogota%';

--2. Mostrar el nombre de los bancos que tienen sucursales en la ciudad de Bogota y que tengan cuentas de ahorros
SELECT B.NAME
FROM BANK B, BANK_BRANCH BB, ACCOUNT A
WHERE B.CODE = BB.CODE AND BB.ADDRESS LIKE '%Bogota%' AND A.TYPE = 'Ahorros';

-- Mostrar tablas
SELECT * FROM BANK;
SELECT * FROM BANK_BRANCH;
SELECT * FROM ACCOUNT;
SELECT * FROM LOAN;
SELECT * FROM CUSTOMER;
SELECT * FROM A_C;
SELECT * FROM L_C;

--spool off



